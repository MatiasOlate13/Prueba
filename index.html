<!DOCTYPE html>
<html>
<head>
<title>Facebook Login JavaScript Example</title>
<meta charset="UTF-8">
</head>
<body>
<script>

  function statusChangeCallback(response) {  //Llamado con los resultados de FB.getLoginStatus ().
    console.log('statusChangeCallback');
    console.log(response);                   //El estado de inicio de sesión actual de la persona.
    if (response.status === 'connected') {   //Ha iniciado sesión en su página web y Facebook.
      testAPI();  
    } else {                                 //No ha iniciado sesión en su página web o no podemos saberlo.
      document.getElementById('status').innerHTML = 'Please log ' +
        'into this webpage.';
    }
  }


  function checkLoginState() {     //Llamado cuando una persona ha terminado con el botón de inicio de sesión.
    FB.getLoginStatus(function(response) {   // Ver el controlador de inicio de sesión
      statusChangeCallback(response);
    });
  }


  window.fbAsyncInit = function() {
    FB.init({
      appId      : '321925395573662',
      cookie     : true,             // Habilite las cookies para permitir que el servidor acceda a la sesión.
      xfbml      : true,             // Analice los complementos sociales en esta página web.
      version    : ' v8.0'           // Utilice esta versión de Graph API para esta llamada.
    });


    FB.getLoginStatus(function(response) {   // Se llama después de que se haya inicializado JS SDK.
      statusChangeCallback(response);        // Devuelve el estado de inicio de sesión.
    });
  };
 
  function testAPI() {           /* Probando Graph API después de iniciar sesión. Consulte 
                                  statusChangeCallback () para saber cuándo se realiza esta llamada.*/
    console.log('Welcome!  Fetching your information.... ');
    FB.api('/me', function(response) {
      console.log('Successful login for: ' + response.name);
      document.getElementById('status').innerHTML =
        'Thanks for logging in, ' + response.name + '!';
    });
  }

</script>

<!-- El botón de inicio de sesión de JS SDK -->

<fb:login-button scope="public_profile,email" onlogin="checkLoginState();">
</fb:login-button>

<div id="status">
</div>

<!-- Cargue el SDK de JS de forma asincrónica -->
<script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js"></script>
</body>
</html>